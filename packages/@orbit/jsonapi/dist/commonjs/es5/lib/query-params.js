'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.encodeQueryParams = encodeQueryParams;
exports.appendQueryParams = appendQueryParams;
function flattenObjectToParams(obj) {
    var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

    var params = [];
    Object.keys(obj).forEach(function (key) {
        if (!obj.hasOwnProperty(key)) {
            return;
        }
        var newPath = path.slice();
        newPath.push(key);
        if (obj[key] !== null && typeof obj[key] === 'object') {
            Array.prototype.push.apply(params, flattenObjectToParams(obj[key], newPath));
        } else {
            params.push({
                path: newPath,
                val: obj[key]
            });
        }
    });
    return params;
}
function encodeQueryParams(obj) {
    return flattenObjectToParams(obj).map(function (param) {
        if (param.path.length === 1) {
            param.path = param.path[0];
        } else {
            var firstSegment = param.path[0];
            var remainingSegments = param.path.slice(1);
            param.path = firstSegment + '[' + remainingSegments.join('][') + ']';
        }
        return param;
    }).map(function (param) {
        return encodeURIComponent(param.path) + '=' + encodeURIComponent(param.val);
    }).join('&');
}
function appendQueryParams(url, obj) {
    var fullUrl = url;
    var queryParams = encodeQueryParams(obj);
    if (queryParams.length > 0) {
        if (fullUrl.indexOf('?') === -1) {
            fullUrl += '?';
        } else {
            fullUrl += '&';
        }
        fullUrl += queryParams;
    }
    return fullUrl;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9xdWVyeS1wYXJhbXMuanMiXSwibmFtZXMiOlsicGF0aCIsInBhcmFtcyIsIk9iamVjdCIsIm9iaiIsIm5ld1BhdGgiLCJBcnJheSIsImZsYXR0ZW5PYmplY3RUb1BhcmFtcyIsInZhbCIsInBhcmFtIiwiZmlyc3RTZWdtZW50IiwicmVtYWluaW5nU2VnbWVudHMiLCJlbmNvZGVVUklDb21wb25lbnQiLCJmdWxsVXJsIiwicXVlcnlQYXJhbXMiLCJlbmNvZGVRdWVyeVBhcmFtcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7UUFtQk8saUIsR0FBQSxpQjtRQVlBLGlCLEdBQUEsaUI7QUEvQlAsU0FBQSxxQkFBQSxDQUFBLEdBQUEsRUFBK0M7QUFBQSxRQUFYQSxPQUFXLFVBQUEsTUFBQSxHQUFBLENBQUEsSUFBQSxVQUFBLENBQUEsTUFBQSxTQUFBLEdBQUEsVUFBQSxDQUFBLENBQUEsR0FBSixFQUFJOztBQUMzQyxRQUFJQyxTQUFKLEVBQUE7QUFDQUMsV0FBQUEsSUFBQUEsQ0FBQUEsR0FBQUEsRUFBQUEsT0FBQUEsQ0FBeUIsVUFBQSxHQUFBLEVBQU87QUFDNUIsWUFBSSxDQUFDQyxJQUFBQSxjQUFBQSxDQUFMLEdBQUtBLENBQUwsRUFBOEI7QUFDMUI7QUFDSDtBQUNELFlBQUlDLFVBQVVKLEtBQWQsS0FBY0EsRUFBZDtBQUNBSSxnQkFBQUEsSUFBQUEsQ0FBQUEsR0FBQUE7QUFDQSxZQUFJRCxJQUFBQSxHQUFBQSxNQUFBQSxJQUFBQSxJQUFxQixPQUFPQSxJQUFQLEdBQU9BLENBQVAsS0FBekIsUUFBQSxFQUF1RDtBQUNuREUsa0JBQUFBLFNBQUFBLENBQUFBLElBQUFBLENBQUFBLEtBQUFBLENBQUFBLE1BQUFBLEVBQW1DQyxzQkFBc0JILElBQXRCRyxHQUFzQkgsQ0FBdEJHLEVBQW5DRCxPQUFtQ0MsQ0FBbkNEO0FBREosU0FBQSxNQUVPO0FBQ0hKLG1CQUFBQSxJQUFBQSxDQUFZO0FBQ1JELHNCQURRLE9BQUE7QUFFUk8scUJBQUtKLElBQUFBLEdBQUFBO0FBRkcsYUFBWkY7QUFJSDtBQWJMQyxLQUFBQTtBQWVBLFdBQUEsTUFBQTtBQUNIO0FBQ00sU0FBQSxpQkFBQSxDQUFBLEdBQUEsRUFBZ0M7QUFDbkMsV0FBTyxzQkFBQSxHQUFBLEVBQUEsR0FBQSxDQUErQixVQUFBLEtBQUEsRUFBUztBQUMzQyxZQUFJTSxNQUFBQSxJQUFBQSxDQUFBQSxNQUFBQSxLQUFKLENBQUEsRUFBNkI7QUFDekJBLGtCQUFBQSxJQUFBQSxHQUFhQSxNQUFBQSxJQUFBQSxDQUFiQSxDQUFhQSxDQUFiQTtBQURKLFNBQUEsTUFFTztBQUNILGdCQUFJQyxlQUFlRCxNQUFBQSxJQUFBQSxDQUFuQixDQUFtQkEsQ0FBbkI7QUFDQSxnQkFBSUUsb0JBQW9CRixNQUFBQSxJQUFBQSxDQUFBQSxLQUFBQSxDQUF4QixDQUF3QkEsQ0FBeEI7QUFDQUEsa0JBQUFBLElBQUFBLEdBQWFDLGVBQUFBLEdBQUFBLEdBQXFCQyxrQkFBQUEsSUFBQUEsQ0FBckJELElBQXFCQyxDQUFyQkQsR0FBYkQsR0FBQUE7QUFDSDtBQUNELGVBQUEsS0FBQTtBQVJHLEtBQUEsRUFBQSxHQUFBLENBU0EsVUFBQSxLQUFBLEVBQUE7QUFBQSxlQUFTRyxtQkFBbUJILE1BQW5CRyxJQUFBQSxJQUFBQSxHQUFBQSxHQUF1Q0EsbUJBQW1CSCxNQUFuRSxHQUFnREcsQ0FBaEQ7QUFUQSxLQUFBLEVBQUEsSUFBQSxDQUFQLEdBQU8sQ0FBUDtBQVVIO0FBQ00sU0FBQSxpQkFBQSxDQUFBLEdBQUEsRUFBQSxHQUFBLEVBQXFDO0FBQ3hDLFFBQUlDLFVBQUosR0FBQTtBQUNBLFFBQUlDLGNBQWNDLGtCQUFsQixHQUFrQkEsQ0FBbEI7QUFDQSxRQUFJRCxZQUFBQSxNQUFBQSxHQUFKLENBQUEsRUFBNEI7QUFDeEIsWUFBSUQsUUFBQUEsT0FBQUEsQ0FBQUEsR0FBQUEsTUFBeUIsQ0FBN0IsQ0FBQSxFQUFpQztBQUM3QkEsdUJBQUFBLEdBQUFBO0FBREosU0FBQSxNQUVPO0FBQ0hBLHVCQUFBQSxHQUFBQTtBQUNIO0FBQ0RBLG1CQUFBQSxXQUFBQTtBQUNIO0FBQ0QsV0FBQSxPQUFBO0FBQ0giLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBmbGF0dGVuT2JqZWN0VG9QYXJhbXMob2JqLCBwYXRoID0gW10pIHtcbiAgICBsZXQgcGFyYW1zID0gW107XG4gICAgT2JqZWN0LmtleXMob2JqKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGlmICghb2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbmV3UGF0aCA9IHBhdGguc2xpY2UoKTtcbiAgICAgICAgbmV3UGF0aC5wdXNoKGtleSk7XG4gICAgICAgIGlmIChvYmpba2V5XSAhPT0gbnVsbCAmJiB0eXBlb2Ygb2JqW2tleV0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShwYXJhbXMsIGZsYXR0ZW5PYmplY3RUb1BhcmFtcyhvYmpba2V5XSwgbmV3UGF0aCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGFyYW1zLnB1c2goe1xuICAgICAgICAgICAgICAgIHBhdGg6IG5ld1BhdGgsXG4gICAgICAgICAgICAgICAgdmFsOiBvYmpba2V5XVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcGFyYW1zO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZVF1ZXJ5UGFyYW1zKG9iaikge1xuICAgIHJldHVybiBmbGF0dGVuT2JqZWN0VG9QYXJhbXMob2JqKS5tYXAocGFyYW0gPT4ge1xuICAgICAgICBpZiAocGFyYW0ucGF0aC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHBhcmFtLnBhdGggPSBwYXJhbS5wYXRoWzBdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IGZpcnN0U2VnbWVudCA9IHBhcmFtLnBhdGhbMF07XG4gICAgICAgICAgICBsZXQgcmVtYWluaW5nU2VnbWVudHMgPSBwYXJhbS5wYXRoLnNsaWNlKDEpO1xuICAgICAgICAgICAgcGFyYW0ucGF0aCA9IGZpcnN0U2VnbWVudCArICdbJyArIHJlbWFpbmluZ1NlZ21lbnRzLmpvaW4oJ11bJykgKyAnXSc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtO1xuICAgIH0pLm1hcChwYXJhbSA9PiBlbmNvZGVVUklDb21wb25lbnQocGFyYW0ucGF0aCkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQocGFyYW0udmFsKSkuam9pbignJicpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGFwcGVuZFF1ZXJ5UGFyYW1zKHVybCwgb2JqKSB7XG4gICAgbGV0IGZ1bGxVcmwgPSB1cmw7XG4gICAgbGV0IHF1ZXJ5UGFyYW1zID0gZW5jb2RlUXVlcnlQYXJhbXMob2JqKTtcbiAgICBpZiAocXVlcnlQYXJhbXMubGVuZ3RoID4gMCkge1xuICAgICAgICBpZiAoZnVsbFVybC5pbmRleE9mKCc/JykgPT09IC0xKSB7XG4gICAgICAgICAgICBmdWxsVXJsICs9ICc/JztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZ1bGxVcmwgKz0gJyYnO1xuICAgICAgICB9XG4gICAgICAgIGZ1bGxVcmwgKz0gcXVlcnlQYXJhbXM7XG4gICAgfVxuICAgIHJldHVybiBmdWxsVXJsO1xufSJdfQ==